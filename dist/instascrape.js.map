{"version":3,"sources":["instascrape.js"],"names":["Object","assign","defineProperty","target","TypeError","to","arguments","length","index","nextSource","nextKey","call","prototype","hasOwnProperty","writable","configurable","InstaScrape","defaults","tag","container","get_data","callback","items","imageSize","imageSizes","240","320","480","640","opts","this","options","isTag","username","valid","console","error","get","url","host","xhr","XMLHttpRequest","_this","onload","readyState","status","data","responseText","split","ProfilePage","parse","substr","entry_data","TagPage","log","statusText","graphql","user","hashtag","open","send","igobj","node","edge_media_to_caption","edges","text","title","accessibility_caption","display","max","html","imageIndex","is_private","edge_hashtag_to_media","imgs","i","shortcode","image","typeResource","caption","parseCaption","__typename","thumbnail_resources","src","thumbnail_src","substring","run","instance"],"mappings":"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","file":"instascrape.js","sourcesContent":["/*\r\n * InstaScrape\r\n *\r\n * @version 1.0.0\r\n *\r\n * @author Katrine-Marie Burmeister\r\n *\r\n * https://github.com/jsanahuja/InstagramFeed\r\n *\r\n */\r\n\r\n // Added for IE11 compatibility\r\n if (typeof Object.assign != 'function') {\r\n  Object.defineProperty(Object, \"assign\", {\r\n    value: function assign(target) {\r\n      'use strict';\r\n      if (target == null) {\r\n        throw new TypeError('Cannot convert undefined or null to object');\r\n      }\r\n\r\n      var to = Object(target);\r\n\r\n      for (var index = 1; index < arguments.length; index++) {\r\n        var nextSource = arguments[index];\r\n\r\n        if (nextSource != null) {\r\n          for (var nextKey in nextSource) {\r\n\r\n            if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n              to[nextKey] = nextSource[nextKey];\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return to;\r\n    },\r\n    writable: true,\r\n    configurable: true\r\n  });\r\n}\r\n\r\nlet InstaScrape = (function(){\r\n    let defaults = {\r\n        'host': \"https://www.instagram.com/\",\r\n        'username': '',\r\n        'tag': '',\r\n        'container': '',\r\n        'get_data': false,\r\n        'callback': null,\r\n        'items': 8,\r\n        'imageSize': 640\r\n    };\r\n\r\n    const imageSizes = {\r\n        \"150\": 0,\r\n        \"240\": 1,\r\n        \"320\": 2,\r\n        \"480\": 3,\r\n        \"640\": 4\r\n    };\r\n\r\n    return function(opts){\r\n        this.options = Object.assign({}, defaults);\r\n        this.options = Object.assign(this.options, opts);\r\n        this.isTag = this.options.username == \"\";\r\n\r\n        this.valid = true;\r\n        if(this.options.username == \"\" && this.options.tag == \"\"){\r\n            console.error(\"InstaScrape: Error: Missing username.\");\r\n            this.valid = false;\r\n        }else if(!this.options.get_data && this.options.container == \"\"){\r\n            console.error(\"InstaScrape: Error, no container found.\");\r\n            this.valid = false;\r\n        }else if(this.options.get_data && typeof this.options.callback != \"function\"){\r\n            console.error(\"InstaScrape: Error, invalid or undefined callback for get_data\");\r\n            this.valid = false;\r\n        }\r\n\r\n        this.get = function(callback){\r\n            let url = this.isTag ? this.options.host + \"explore/tags/\" + this.options.tag : this.options.host + this.options.username,\r\n                xhr = new XMLHttpRequest();\r\n\r\n            let _this = this;\r\n            xhr.onload = function(){\r\n                if(xhr.readyState === 4){\r\n                    if (xhr.status === 200) {\r\n                        let data = xhr.responseText.split(\"window._sharedData = \")[1].split(\"</script>\")[0];\r\n                        data = JSON.parse(data.substr(0, data.length - 1));\r\n                        data = data.entry_data.ProfilePage || data.entry_data.TagPage || null;\r\n                        if(data === null){\r\n                            console.log(url);\r\n                            console.error(\"InstaScrape: Request error. No data retrieved: \" + xhr.statusText);\r\n                        }else{\r\n                            data = data[0].graphql.user || data[0].graphql.hashtag;\r\n                            callback(data, _this);\r\n                        }\r\n                    } else {\r\n                        console.error(\"InstaScrape: Request error. Response: \" + xhr.statusText);\r\n                    }\r\n                }\r\n            };\r\n            xhr.open(\"GET\", url, true);\r\n            xhr.send();\r\n        };\r\n\r\n        this.parseCaption = function(igobj, data){\r\n            if(typeof igobj.node.edge_media_to_caption.edges[0] !== \"undefined\" && igobj.node.edge_media_to_caption.edges[0].node.text.length != 0){\r\n                return igobj.node.edge_media_to_caption.edges[0].node.text;\r\n            }\r\n\r\n            if(typeof igobj.node.title !== \"undefined\" && igobj.node.title.length != 0){\r\n                return igobj.node.title;\r\n            }\r\n\r\n            if(typeof igobj.node.accessibility_caption !== \"undefined\" && igobj.node.accessibility_caption.length != 0){\r\n                return igobj.node.accessibility_caption;\r\n            }\r\n            return (this.isTag ? data.name : data.username) + \" image \";\r\n        }\r\n\r\n        this.display = function(data){\r\n          let max = '';\r\n          let html = '';\r\n\r\n            // Gallery\r\n            let imageIndex = typeof imageSizes[this.options.imageSize] !== \"undefined\" ? imageSizes[this.options.imageSize] : imageSizes[640];\r\n\r\n            if(typeof data.is_private !== \"undefined\" && data.is_private === true){\r\n              console.log('This profile is private');\r\n            }else{\r\n              let imgs = (data.edge_owner_to_timeline_media || data.edge_hashtag_to_media).edges;\r\n                max = (imgs.length > this.options.items) ? this.options.items : imgs.length;\r\n\r\n                html = '';\r\n\r\n                html += \"<div class='instagram_gallery'>\";\r\n\r\n                for(var i = 0; i < max; i++){\r\n                    let url = \"https://www.instagram.com/p/\" + imgs[i].node.shortcode,\r\n                    image, typeResource,\r\n                    caption = this.parseCaption(imgs[i], data);\r\n\r\n                    switch(imgs[i].node.__typename){\r\n                      case \"GraphSidecar\":\r\n                        typeResource = \"sidecar\"\r\n                        image = imgs[i].node.thumbnail_resources[imageIndex].src;\r\n                        break;\r\n                      case \"GraphVideo\":\r\n                        typeResource = \"video\";\r\n                        image = imgs[i].node.thumbnail_src\r\n                      break;\r\n                        default:\r\n                        typeResource = \"image\";\r\n                        image = imgs[i].node.thumbnail_resources[imageIndex].src;\r\n                      }\r\n\r\n                      if (this.isTag) { data.username = ''; }\r\n                      html += \"<a href='\" + url +\"' class='instagram-\" + typeResource + \"' title='\" + caption.substring(0, 100) + \"' rel='noopener' target='_blank'>\";\r\n                      html += \"<img src='\" + image + \"' alt='\" + caption.substring(0, 100) + \"' />\";\r\n                      html += \"</a>\";\r\n                    }\r\n\r\n                    html += \"</div>\";\r\n                }\r\n\r\n            this.options.container.innerHTML = html;\r\n        };\r\n\r\n        this.run = function(){\r\n            this.get(function(data, instance){\r\n                if(instance.options.get_data) {\r\n                    instance.options.callback(data);\r\n                } else {\r\n                    instance.display(data);\r\n                }\r\n            });\r\n        };\r\n\r\n        if(this.valid){\r\n            this.run();\r\n        }\r\n    };\r\n})();\r\n"]}