{"version":3,"sources":["instascrape.js"],"names":["Object","assign","defineProperty","varArgs","target","TypeError","to","arguments","length","index","nextSource","nextKey","call","prototype","hasOwnProperty","writable","configurable","InstaScrape","defaults","tag","container","get_data","callback","items","image_size","image_sizes","240","320","480","640","opts","this","options","is_tag","username","valid","console","error","get","url","host","xhr","XMLHttpRequest","_this","onload","e","readyState","status","data","responseText","split","ProfilePage","parse","substr","entry_data","TagPage","log","statusText","graphql","user","hashtag","open","send","igobj","node","edge_media_to_caption","edges","text","title","accessibility_caption","display","max","html","image_index","is_private","edge_hashtag_to_media","imgs","i","image","type_resource","shortcode","caption","parse_caption","__typename","thumbnail_resources","src","thumbnail_src","substring","innerHTML","run","instance"],"mappings":"aAWC,mBAAAA,OAAAC,QACAD,OAAIE,eAAAF,OAAwB,SAAY,CACvCA,MAAOE,SAAeF,EAAQG,GAE1B,GAAA,MAAAC,EAEE,MAAM,IAAIC,UAAU,8CAGtB,IAFC,IAAAC,EAAAN,OAAAI,GAEQJ,EAAOI,EAAAA,EAAhBG,UAAAC,OAAAC,IAAA,CAGE,IAAIC,EAAaH,UAAUE,GAA3B,GAAiBF,MAAbG,EAGF,IAAK,IAAIC,KAAWD,EAAfV,OAAIW,UAAWD,eAAYE,KAAAF,EAAAC,KAE9BL,EAAIN,GAAOa,EAAUC,IAK1B,OAAAR,GACDS,UAAOT,EACRU,cAtBqC,IA0BzC,IAAAC,YAAA,WAGG,IAAIC,EAAW,CADfD,KAAW,6BACPC,SAAW,GACXC,IAAQ,GACRC,UAFW,GAGXC,UAHW,EAIXC,SAJW,KAKXC,MAAY,GACZC,WANW,KAAfC,EAAA,CAWIA,IAAAA,EACAC,IADc,EAEdC,IAFc,EAGdC,IAHc,EAIdC,IAJc,GAQlB,OAAO,SAASC,GACZC,KAAKC,QAAUhC,OAAOC,OAAWiB,GAAAA,GACjCa,KAAKC,QAAUhC,OAAOC,OAAO8B,KAAKC,QAAnBF,GACfC,KAAKE,OAAL,IAAcF,KAAKC,QAAQE,SAE3BH,KAAKI,OAAQ,EACV,IAAAJ,KAAKC,QAAQE,UAAhB,IAAkCH,KAAKC,QAALb,KAC9BiB,QAAcC,MAAA,yCACTF,KAALA,OAAA,GACMJ,KAAKC,QAAQX,UAAjB,IAA6BU,KAAKC,QAAQZ,UAGvCW,KAAKC,QAAQX,UAA4C,mBAAzBU,KAAKC,QAAQV,WAClDc,QAAcC,MAAA,kEACTF,KAALA,OAAA,IAJAC,QAAcC,MAAA,2CACTF,KAALA,OAAA,GAMJJ,KAAAO,IAAW,SAAShB,GACZiB,IAAMA,EAAKN,KAALA,OAAmBD,KAAAA,QAALQ,KAAoB,gBAAuBR,KAAAA,QAAcb,IAAKa,KAAAA,QAALQ,KAAyBR,KAAAA,QAAQE,SACxGO,EAAIC,IAAAA,eAELC,EAATZ,KACAU,EAAIG,OAAS,SAASC,GAAtB,GAAwB,IAAXJ,EAAAK,WACFA,GAAiB,MAAjBA,EAAJC,OAAqB,CAChB,IAAAC,EAAoBP,EAAAQ,aAAAC,MAAA,yBAAA,GAAAA,MAAA,cAAA,GAGGC,QADXC,GADDX,EAAIQ,KAAAA,MAAaC,EAAMG,OAAA,EAAAL,EAAAxC,OAAyB,KACpC6C,WAAUL,aAAjCA,EAAAM,WAAAC,SAAA,OAGInB,QAAQoB,IAAIjB,GADJH,QAAKC,MAAA,kDAAAI,EAAAgB,cAECT,EAAAA,EAAA,GAAAU,QAAAC,MAAAX,EAAA,GAAAU,QAAAE,QACbtC,EAAA0B,EAAAL,SAGJP,QAAAC,MAAA,yCAAAI,EAAAgB,aAIRhB,EAAAoB,KAAA,MAAAtB,GAAA,GAhBLE,EAAAqB,QAmBArB,KAAIqB,cAAJ,SAAAC,EAAAf,GAxBJ,YAAA,IAAAe,EAAAC,KAAAC,sBAAAC,MAAA,IAAA,GAAAH,EAAAC,KAAAC,sBAAAC,MAAA,GAAAF,KAAAG,KAAA3D,OA6BeuD,EAAMC,KAAKC,sBAAsBC,MAAM,GAAGF,KAAKG,UAApCF,IAALD,EAAKC,KAAAA,OAAlB,GAAiDD,EAAKG,KAAtDC,MAAA5D,OACHuD,EAAAC,KAAAI,WAGG,IAAaJ,EAAKI,KAAlBC,uBAAA,GAAAN,EAAAC,KAAAK,sBAAA7D,OACHuD,EAAAC,KAAAK,uBAESN,KAAMC,OAAKK,EAAAA,KAAAA,EAAlBnC,UAA4C,WAMnDH,KAAKuC,QAAU,SAAStB,GAHpB,IAAQuB,EAAKtC,GAZjBuC,EAAA,GAgBYC,OAAV,IAAAhD,EAAAM,KAAAC,QAAAR,YAAAC,EAAAM,KAAAC,QAAAR,YAAAC,EAAA,KAME,QAA8B,IAApBuB,EAAK0B,aAAkD,IAApB1B,EAAK0B,WAF9CD,QAAWjB,IAAG,+BAIb,CAFF,IAAOR,GAAK0B,EAAAA,8BAAmCA,EAALC,uBAAyBT,MAC5DV,EAAIoB,EAAApE,OAAAuB,KAAAC,QAAZT,MAAAQ,KAAAC,QAAAT,MAAAqD,EAAApE,OAEQgE,EAAIxB,GAGHwB,GAAP,kCAIA,IAAI,IAAIK,EAAI,EAAGA,EAAIN,EAAKM,IAAI,CAAnB,IACKC,EAAAC,EADCF,EAAIN,+BAASK,EAAAC,GAAAb,KAAAgB,UACxBC,EAAAlD,KAAAmD,cAAAN,EAAAC,GAAA7B,GAEAiC,OAAUL,EAAKM,GAAAA,KAAAA,YAGb,IAAK,eADIH,EAASI,UACbL,EAALF,EAAAC,GAAAb,KAAAoB,oBAAAX,GAAAY,IACEN,MACQH,IAAKC,aACbE,EAAA,QAGAD,EAAQF,EAAKC,GAAGb,KAAKsB,cAFlB,MACHP,QACQH,EAAaU,QACvBR,EAAAF,EAAAC,GAAAb,KAAAoB,oBAAAX,GAAAY,IAEEN,KAAgB9C,SAAhBe,EAAAd,SAAA,IACQ0C,GAAQZ,YAAKoB,EAAAA,sBAArBL,EAAA,YAAAE,EAAAM,UAAA,EAAA,KAAA,oCAXJf,GAAA,aAAAM,EAAA,UAAAG,EAAAM,UAAA,EAAA,KAAA,MAiBEf,GAAQ,OADAA,GAAA,SAOlBzC,KAAKC,QAAQZ,UAAUoE,UAAYhB,GAGvCzC,KAAK0D,IAAM,WAHFzD,KAAAA,IAAQZ,SAAUoE,EAAAA,GA7C3BE,EAAA1D,QAAAX,SAmDYqE,EAAS1D,QAAQV,SAAS0B,GAFzB0C,EAAApB,QAAeoB,MAQzB3D,KAAKI,OAALJ,KAAKI,OA1If","file":"instascrape.js","sourcesContent":["/*\r\n * InstaScrape\r\n *\r\n * @version 1.0.0\r\n *\r\n * @author Katrine-Marie Burmeister\r\n *\r\n * https://github.com/jsanahuja/InstagramFeed\r\n *\r\n */\r\n\r\n // Added for IE11 compatibility\r\n if (typeof Object.assign != 'function') {\r\n  Object.defineProperty(Object, \"assign\", {\r\n    value: function assign(target, varArgs) {\r\n      'use strict';\r\n      if (target == null) {\r\n        throw new TypeError('Cannot convert undefined or null to object');\r\n      }\r\n\r\n      var to = Object(target);\r\n\r\n      for (var index = 1; index < arguments.length; index++) {\r\n        var nextSource = arguments[index];\r\n\r\n        if (nextSource != null) {\r\n          for (var nextKey in nextSource) {\r\n\r\n            if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n              to[nextKey] = nextSource[nextKey];\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return to;\r\n    },\r\n    writable: true,\r\n    configurable: true\r\n  });\r\n}\r\n\r\nvar InstaScrape = (function(){\r\n    var defaults = {\r\n        'host': \"https://www.instagram.com/\",\r\n        'username': '',\r\n        'tag': '',\r\n        'container': '',\r\n        'get_data': false,\r\n        'callback': null,\r\n        'items': 12,\r\n        'image_size': 640\r\n    };\r\n\r\n    var image_sizes = {\r\n        \"150\": 0,\r\n        \"240\": 1,\r\n        \"320\": 2,\r\n        \"480\": 3,\r\n        \"640\": 4\r\n    };\r\n\r\n    return function(opts){\r\n        this.options = Object.assign({}, defaults);\r\n        this.options = Object.assign(this.options, opts);\r\n        this.is_tag = this.options.username == \"\";\r\n\r\n        this.valid = true;\r\n        if(this.options.username == \"\" && this.options.tag == \"\"){\r\n            console.error(\"InstaScrape: Error: Missing username.\");\r\n            this.valid = false;\r\n        }else if(!this.options.get_data && this.options.container == \"\"){\r\n            console.error(\"InstaScrape: Error, no container found.\");\r\n            this.valid = false;\r\n        }else if(this.options.get_data && typeof this.options.callback != \"function\"){\r\n            console.error(\"InstaScrape: Error, invalid or undefined callback for get_data\");\r\n            this.valid = false;\r\n        }\r\n\r\n        this.get = function(callback){\r\n            var url = this.is_tag ? this.options.host + \"explore/tags/\" + this.options.tag : this.options.host + this.options.username,\r\n                xhr = new XMLHttpRequest();\r\n\r\n            var _this = this;\r\n            xhr.onload = function(e){\r\n                if(xhr.readyState === 4){\r\n                    if (xhr.status === 200) {\r\n                        var data = xhr.responseText.split(\"window._sharedData = \")[1].split(\"<\\/script>\")[0];\r\n                        data = JSON.parse(data.substr(0, data.length - 1));\r\n                        data = data.entry_data.ProfilePage || data.entry_data.TagPage || null;\r\n                        if(data === null){\r\n                            console.log(url);\r\n                            console.error(\"InstaScrape: Request error. No data retrieved: \" + xhr.statusText);\r\n                        }else{\r\n                            data = data[0].graphql.user || data[0].graphql.hashtag;\r\n                            callback(data, _this);\r\n                        }\r\n                    } else {\r\n                        console.error(\"InstaScrape: Request error. Response: \" + xhr.statusText);\r\n                    }\r\n                }\r\n            };\r\n            xhr.open(\"GET\", url, true);\r\n            xhr.send();\r\n        };\r\n\r\n        this.parse_caption = function(igobj, data){\r\n            if(typeof igobj.node.edge_media_to_caption.edges[0] !== \"undefined\" && igobj.node.edge_media_to_caption.edges[0].node.text.length != 0){\r\n                return igobj.node.edge_media_to_caption.edges[0].node.text;\r\n            }\r\n\r\n            if(typeof igobj.node.title !== \"undefined\" && igobj.node.title.length != 0){\r\n                return igobj.node.title;\r\n            }\r\n\r\n            if(typeof igobj.node.accessibility_caption !== \"undefined\" && igobj.node.accessibility_caption.length != 0){\r\n                return igobj.node.accessibility_caption;\r\n            }\r\n            return (this.is_tag ? data.name : data.username) + \" image \";\r\n        }\r\n\r\n        this.display = function(data){\r\n          var max = '';\r\n          var html = '';\r\n\r\n            // Gallery\r\n            var image_index = typeof image_sizes[this.options.image_size] !== \"undefined\" ? image_sizes[this.options.image_size] : image_sizes[640];\r\n\r\n            if(typeof data.is_private !== \"undefined\" && data.is_private === true){\r\n              console.log('This profile is private');\r\n            }else{\r\n              var imgs = (data.edge_owner_to_timeline_media || data.edge_hashtag_to_media).edges;\r\n                max = (imgs.length > this.options.items) ? this.options.items : imgs.length;\r\n\r\n                html = '';\r\n\r\n                html += \"<div class='instagram_gallery'>\";\r\n\r\n                for(var i = 0; i < max; i++){\r\n                    var url = \"https://www.instagram.com/p/\" + imgs[i].node.shortcode,\r\n                    image, type_resource,\r\n                    caption = this.parse_caption(imgs[i], data);\r\n\r\n                    switch(imgs[i].node.__typename){\r\n                      case \"GraphSidecar\":\r\n                        type_resource = \"sidecar\"\r\n                        image = imgs[i].node.thumbnail_resources[image_index].src;\r\n                        break;\r\n                      case \"GraphVideo\":\r\n                        type_resource = \"video\";\r\n                        image = imgs[i].node.thumbnail_src\r\n                      break;\r\n                        default:\r\n                        type_resource = \"image\";\r\n                        image = imgs[i].node.thumbnail_resources[image_index].src;\r\n                      }\r\n\r\n                      if (this.is_tag) data.username = '';\r\n                      html += \"<a href='\" + url +\"' class='instagram-\" + type_resource + \"' title='\" + caption.substring(1, 100) +\"' rel='noopener' target='_blank'>\";\r\n                      html += \"<img src='\" + image + \"' alt='\" + caption.substring(1, 100) + \" />\";\r\n                      html += \"</a>\";\r\n                    }\r\n\r\n                    html += \"</div>\";\r\n                }\r\n\r\n            this.options.container.innerHTML = html;\r\n        };\r\n\r\n        this.run = function(){\r\n            this.get(function(data, instance){\r\n                if(instance.options.get_data)\r\n                    instance.options.callback(data);\r\n                else\r\n                    instance.display(data);\r\n            });\r\n        };\r\n\r\n        if(this.valid){\r\n            this.run();\r\n        }\r\n    };\r\n})();\r\n"]}